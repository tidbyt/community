"""
Applet: Strava
Summary: Displays athlete stats
Description: Displays your YTD or all-time athlete stats recorded on Strava.
Author: Rob Kimball
"""

load("cache.star", "cache")
load("encoding/base64.star", "base64")
load("encoding/json.star", "json")
load("http.star", "http")
load("humanize.star", "humanize")
load("math.star", "math")
load("render.star", "render")
load("schema.star", "schema")
load("secret.star", "secret")
load("time.star", "time")

STRAVA_BASE = "https://www.strava.com/api/v3"
CLIENT_ID = "79662"
OAUTH2_CLIENT_SECRET = secret.decrypt("AV6+xWcE+oJPK08TUWRIoZPgneZiZsTciGafVUjbKA7elXuSDBS9h4koiu0kak1WthqS5W/HvXQtBM5kF7k8BMSgyIPNTBNEgep8BwAph7naog0GdcWLGKo2/eoQlXUSSVYtnBGc9EoxSp7soyw6BdMTOQgrnzOips7RKsI92CcSt4wzfQj/QTkSp6IyeA==")
DEFAULT_UNITS = "imperial"
DEFAULT_SPORT = "ride"
DEFAULT_SCREEN = "all"

RATE_LIMIT_DEFAULT_BACKOFF_SECONDS = 15 * 60
RATE_LIMIT_CACHE_KEY = "rate-limit-backoff"

PREVIEW_DATA = {
    "count": 1408,
    "distance": 56159815,
    "moving_time": 2318919,
    "elapsed_time": 2615958,
    "elevation_gain": 125800,
}

CACHE_TTL = 60 * 60 * 18  # updates once every 36 hours

RUN_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAAXNSR0IArs4c6QAAAGpJREFUGFdj
ZMACKkM9/oOE21fvYIRJwxkwAZCithoLMJdRvwG7wv9dDf+Pz1vB8PHLF7BCzydPGEFijGUNjBgm
ghRsl5EBW83Pw8NgdeMGWA2GwmMaGv+RTcTqxrL/zP+7GP+CNSOzQXwAmAopB3+7+0kAAAAASUVO
RK5CYII=
""")

RIDE_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAAXNSR0IArs4c6QAAAGpJREFUGFd
jZICCkLyq/zD2mkltjCB2Qm03XAwsAAPHNDTgEjAxqxs3GEEawAr//////7imJgNIEMQHabC8fp
0BJAaiGUEApAhEI0uCNCBrBqtBVggyDWYqTBxmI9xqkADIZGQ3gxRDxRkAODJIzA34xRoAAAAAS
UVORK5CYII=
""")

SWIM_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAAXNSR0IArs4c6QAAAFpJREFUGFd
jZCASMMLU/f///z+MzcjICBaHiYH4jMgcdEkUhcg2I5vKsuorw99wHriNGFYrTf/C8EiYkUHu7X
+G+2oPGRhcdMBqwITitM//YZJwRVm8cENAagAl0DAHMC2dNAAAAABJRU5ErkJggg==
""")

CLOCK_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAAXNSR0IArs4c6QAAAGRJREFUGFdj
ZGBg+M8ABf//w5lgEUZGRpgUA4gFlgUrmgmRSDqZyDDPfD4DQ/p/uGKsCp1XOTHsFX3AwLDiLnaF
SUlJDA8fPmS4f/8+wz0zRtwKGSKU4W4CM7CZCHcnklJkzwAAzHgtAXQJ+34AAAAASUVORK5CYII=
""")

ELEV_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAAXNSR0IArs4c6QAAAIBJREFUGFd
jZICCN+8//hcR5GeE8dFpuARIIUgSpvjXr1//2djY4PJgBkzRl4/vwQZJSUkxPHv2jKGkbxbDmk
ltYDVgomLCnP8v3r5ngCkEiakoKYE13bl3D6yYEaQIJABSCAIwxSCFyGKM0nEKYIUw4CqfDVd8/
MMysLClQBQDADOaPH3ku/SjAAAAAElFTkSuQmCC
""")

DISTANCE_ICON = base64.decode("""
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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
""")

DISTANCE_ICON_FIXED = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAAXNSR0IArs4c6QAAAEtJREFUGFd
jZCAAeN0X/v+8M56REZ86kKJPO+IY+DwWMYAV/g9X+g+iGVfeQ9EIUggziBGkCKYAnQ1SxPehng
Gr1eimwzTjdSOy+wFaLiTvmqj9hwAAAABJRU5ErkJggg==
""")

PR_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAAAXNSR0IArs4c6QAAAERlWElmTU0
AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAABqADAAQAAA
ABAAAABgAAAABrkD2lAAAAWUlEQVQIHWN8ukbpPwMIcDCDKRDx6t5zBkYQ4+kWVYjkj78Mr569Y
jDM+8LIBJIAA6jg9y9/wVy4BEglMgBLSPvcZgSpBGGrqu9g48HEnipGiB1QLS5t/xkBgJYlhpF+
DqcAAAAASUVORK5CYII=
""")

HEART_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAAXNSR0IArs4c6QAAAERlWElmTU0
AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAB6ADAAQAAA
ABAAAABgAAAADsNvbmAAAAZklEQVQIHWNgAIIPvU3/QRjEfu5r8x+EQWxGkCCrpi7D7+uXGf48e
cjw+85Nhv/s3AyXX71kYAKpwCZx+/M3BkaQ5JvC5P/IOkASOedvMYIlQQqehbj/BxkFkwCJoYAp
hmpgh8AEAeNyQoGVq7nIAAAAAElFTkSuQmCC
""")

KUDOS_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAAXNSR0IArs4c6QAAAERlWElmTU0
AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAB6ADAAQAAA
ABAAAABgAAAADsNvbmAAAAXklEQVQIHWNgQAJfv379j8RlYELmoLOZKibM+Z9Q2w3W8fPnT4Z37
979B2GQQhaY6gcPHvz/9OkTjMuwd+/e/3BJPj4+uMT58+cZHj58iNApJCTEOG/ePLiDkpKSGAEl
ZyaSy2CBIgAAAABJRU5ErkJggg==
""")

ACHIEVEMENT_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAAAXNSR0IArs4c6QAAAERlWElmTU0
AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAABqADAAQAAA
ABAAAABgAAAABrkD2lAAAAMElEQVQIHWOcOnXqfwZcAFmyu7sbrJAJl2KcEnANICNgxoAEGUFEf
X09igMaGxsZAeczEWNoVg96AAAAAElFTkSuQmCC
""")

KCAL_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAAXNSR0IArs4c6QAAAERlWElmTU0
AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAB6ADAAQAAA
ABAAAABgAAAADsNvbmAAAAZklEQVQIHWNgQAJfetj+gzBMiAnGAAlyOwcyfLn4DybEwAhigSX0m
Bh+v/zP8AuIn5/9y6C6/C8jXCdMAqTzzee/YN0sYJ1IRt1//4dB9DFIzz+IsSAFd/SZ/r+W/QeW
ULn4D2wdAPH3MeVIneA3AAAAAElFTkSuQmCC
""")

SUFFER_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAAXNSR0IArs4c6QAAAERlWElmTU0
AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAB6ADAAQAAA
ABAAAABgAAAADsNvbmAAAAOklEQVQIHWO8uWLFfwYkoB4RwQjjMsEY2GjG3wySKDphilgZnjPi1
cmyk/knTDGDz993cPtAgnh1AgCjmgr6kSEpEwAAAABJRU5ErkJggg==
""")

WATTS_ICON = base64.decode("""
iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAAXNSR0IArs4c6QAAAERlWElmTU0
AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAB6ADAAQAAA
ABAAAABgAAAADsNvbmAAAARklEQVQIHWNgQAJ//x/6D8Jf77n/RxJmYAAJfv/+HUWCEaQCJAGif
zw7DqIYGH7uY+BW2gmWgwgAya9PO1F0EiGB7gCoFgC8DS5ePrnJYwAAAABJRU5ErkJggg==
""")

def main(config):
    refresh_token = config.get("auth")
    sport = config.get("sport", DEFAULT_SPORT)
    units = config.get("units", DEFAULT_UNITS)
    display_type = config.get("display_type", DEFAULT_SCREEN)

    if refresh_token and is_rate_limited():
        # logged-in user but we have been rate-limited by Strava. can't render anything
        # until the backoff expires.
        return []

    if display_type in ("ytd", "all"):
        return athlete_stats(config, refresh_token, display_type, sport, units)
    elif display_type == "progress_chart":
        return progress_chart(config, refresh_token, sport, units)
    elif display_type == "last_activity":
        return last_activity(config, refresh_token, sport, units)
    else:
        print("Display type %s was invalid, showing the %s screen instead." % (display_type, DEFAULT_SCREEN))
        return athlete_stats(config, refresh_token, DEFAULT_SCREEN, sport, units)

def progress_chart(config, refresh_token, sport, units):
    show_logo = config.bool("show_logo", True)
    no_anim = config.bool("no_anim", False)

    distance_conv = meters_to_mi
    if units == "metric":
        distance_conv = meters_to_km

    activities = get_activities(config, refresh_token)

    # This is duped from the get_activities function but we still need this info for this display
    timezone = config.get("timezone") or "America/New_York"
    now = time.now().in_location(timezone)
    beg_curr_month = time.time(year = now.year, month = now.month, day = 1)
    _next_month = time.time(year = now.year, month = now.month, day = 32)
    end_curr_month = time.time(year = _next_month.year, month = _next_month.month, day = 1) - time.parse_duration("1ns")
    end_prev_month = beg_curr_month - time.parse_duration("1ns")
    beg_prev_month = time.time(year = end_prev_month.year, month = end_prev_month.month, day = 1)

    stat_keys = ("distance", "moving_time", "total_elevation_gain")
    graph_stat = stat_keys[0]

    # Iterate through each activity from the current and previous month and extract the relevant data, adding it
    # to our cumulative totals as we go, which are later used in our plot.
    included_current_activities = []
    cumulative_current = {k: 0 for k in stat_keys}
    for item in activities["current"]:
        if item["type"].lower() == sport:
            activity_time = time.parse_time(item["start_date"])
            activity_epoch = activity_time.unix
            activity_stats = {k: item.get(k, 0) for k in stat_keys}
            activity_stats["time"] = activity_time
            activity_stats["date_pct"] = (activity_epoch - beg_curr_month.unix) / (end_curr_month.unix - beg_curr_month.unix)
            cumulative_current = {k: cumulative_current.get(k, 0) + activity_stats.get(k, 0) for k in stat_keys}
            activity_stats.update({
                "cum_%s" % k: round(cumulative_current.get(k, 0), 2)
                for k in stat_keys
            })
            included_current_activities.append(activity_stats)
            print(activity_stats)
        else:
            print("Found non-%s activity (%s), skipping" % (sport, item["type"]))

    included_previous_activities = []
    cumulative_previous = {k: 0 for k in stat_keys}
    for item in activities["previous"]:
        if item["type"].lower() == sport:
            activity_time = time.parse_time(item["start_date"])
            activity_epoch = activity_time.unix
            activity_stats = {k: item.get(k, 0) for k in stat_keys}
            activity_stats["time"] = activity_time
            activity_stats["date_pct"] = (activity_epoch - beg_prev_month.unix) / (end_prev_month.unix - beg_prev_month.unix)
            cumulative_previous = {k: cumulative_previous.get(k, 0) + activity_stats.get(k, 0) for k in stat_keys}
            activity_stats.update({
                "cum_%s" % k: round(cumulative_previous.get(k, 0), 2)
                for k in stat_keys
            })
            included_previous_activities.append(activity_stats)
            print(activity_stats)
        else:
            print("Found non-%s activity (%s), skipping" % (sport, item["type"]))

    # Start both plots off at the origin and then add converted distance at each time stamp.
    # We use the percentage of the month here to align the axis of months that consist of a different number of days
    # Immediately before each activity we add the previous distance to create the "step" effect in the graph
    curr_plot = [(0.0, 0.0)]
    for item in included_current_activities:
        curr_plot.append((item["date_pct"] - .025, curr_plot[-1][1]))
        curr_plot.append((item["date_pct"], distance_conv(item["cum_%s" % graph_stat])))

    prev_plot = [(0.0, 0.0)]
    for item in included_previous_activities:
        prev_plot.append((item["date_pct"] - .025, prev_plot[-1][1]))
        prev_plot.append((item["date_pct"], distance_conv(item["cum_%s" % graph_stat])))

    # At the end of the current plot we want today's date as a percentage of the month,
    now_date_pct = (now.unix - beg_curr_month.unix) / (end_curr_month.unix - beg_curr_month.unix)
    curr_plot.append((now_date_pct, curr_plot[-1][1]))

    # ...and at the end of the previous plot we want 100% of the month to be our final cumulative number
    prev_plot.append((1.0, prev_plot[-1][1]))

    plot_height = max([prev_plot[-1][1], curr_plot[-1][1]])

    title_font = "CG-pixel-3x5-mono"

    total_time = time.parse_duration("%ss" % cumulative_current.get("moving_time", 0))
    if len(included_current_activities):
        total_time = format_duration(total_time, resolution = "hours")
    else:
        total_time = "0:00"

    logo = []
    if show_logo:
        sport_icon = {
            "run": RUN_ICON,
            "ride": RIDE_ICON,
            "swim": SWIM_ICON,
        }[sport]
        logo.append(
            render.Column(
                expanded = True,
                main_align = "end",
                cross_align = "end",
                children = [render.Image(src = sport_icon)],
            ),
        )
        graph_width = 54
    else:
        graph_width = 64

    if sport == "ride":
        value = cumulative_current["total_elevation_gain"]
        if units == "imperial":
            value = meters_to_ft(value)

        if value == 0 and len(curr_plot) > 0:
            # We can assume the athlete is using a trainer here and would rather not see elevation
            third_stat = {
                "title": sport + "s",
                "value": len(included_current_activities),
            }
        else:
            third_stat = {
                "title": "Elev",
                "value": int(value),
            }
    else:
        third_stat = {
            "title": sport + "s",
            "value": len(included_current_activities),
        }

    frames = []
    num_frames = len(prev_plot) + len(curr_plot)
    for i in range(num_frames + 1):
        frames.append(
            render.Stack(
                children = [
                    # Using a column here so I can place the logo in the bottom corner
                    render.Row(
                        expanded = True,
                        main_align = "start",
                        cross_align = "start",
                        children = logo,
                    ),
                    render.Row(
                        expanded = True,
                        main_align = "end",
                        cross_align = "end",
                        children = [
                            render.Column(
                                expanded = True,
                                main_align = "end",
                                children = [
                                    render.Plot(
                                        data = prev_plot[0:i],
                                        width = graph_width,
                                        height = 22,
                                        color = "#787878",
                                        y_lim = (0.0, plot_height),
                                        x_lim = (0.0, 1.0),
                                        fill = False,
                                    ),
                                ],
                            ),
                        ],
                    ),
                    render.Row(
                        expanded = True,
                        main_align = "end",
                        cross_align = "end",
                        children = [
                            render.Column(
                                expanded = True,
                                main_align = "end",
                                children = [
                                    render.Plot(
                                        data = curr_plot[0:i - len(prev_plot)],
                                        width = graph_width,
                                        height = 22,
                                        color = "#fc4c02",
                                        y_lim = (0.0, plot_height),
                                        x_lim = (0.0, 1.0),
                                        fill = False,
                                    ),
                                ] if i > len(prev_plot) else [],
                            ),
                        ],
                    ),
                    render.Row(
                        expanded = True,
                        main_align = "space_evenly",
                        cross_align = "center",
                        children = [
                            render.Column(
                                main_align = "center",
                                cross_align = "center",
                                children = [
                                    render.Text("Time", color = "#fc4c02", font = title_font),
                                    render.Text(total_time, color = "#FFF"),
                                ],
                            ),
                            render.Column(
                                cross_align = "center",
                                children = [
                                    render.Text("Dist", color = "#fc4c02", font = title_font),
                                    render.Text(
                                        humanize.comma(math.round(distance_conv(cumulative_current["distance"]))),
                                        color = "#FFF",
                                    ),
                                ],
                            ),
                            render.Column(
                                main_align = "center",
                                cross_align = "center",
                                children = [
                                    render.Text(third_stat["title"], color = "#fc4c02", font = title_font),
                                    render.Text(
                                        humanize.comma(third_stat["value"]),
                                        color = "#FFF",
                                    ),
                                ],
                            ),
                        ],
                    ),
                ],
            ),
        )

    if no_anim:
        frames = [frames[-1]]
    else:
        # Repeat last frame for a long time
        frames.extend([frames[-1]] * 400)

    return render.Root(
        delay = 50,
        child = render.Animation(
            children = frames,
        ),
    )

def athlete_stats(config, refresh_token, period, sport, units):
    no_anim = config.bool("no_anim", False)
    timezone = config.get("timezone") or "America/New_York"
    year = time.now().in_location(timezone).year

    if not refresh_token:
        stats = ["count", "distance", "moving_time", "elapsed_time", "elevation_gain"]
        stats = {k: PREVIEW_DATA[k] for k in stats}
    else:
        access_token = cache.get(refresh_token)
        if not access_token:
            print("Generating new access token")
            access_token = get_access_token(refresh_token)

        headers = {
            "Authorization": "Bearer %s" % access_token,
        }

        cache_prefix = "%s/%s/%s/" % (refresh_token, sport, period)

        # Get logged in athlete
        athlete = cache.get("%s/athlete_id" % refresh_token)
        if not athlete:
            print("Getting athlete ID from API, access_token was cached.")
            url = "%s/athlete" % STRAVA_BASE
            response = http_get(url, headers = headers)

            if response.status_code != 200:
                text = "code %d, %s" % (response.status_code, json.decode(response.body()).get("message", ""))
                return display_failure("Strava API failed, %s" % text)

            data = response.json()
            athlete = int(float(data["id"]))

            # TODO: Determine if this cache call can be converted to the new HTTP cache.
            cache.set("%s/athlete_id" % refresh_token, str(athlete), ttl_seconds = CACHE_TTL)

        stats = ["count", "distance", "moving_time", "elapsed_time", "elevation_gain"]
        stats = {k: cache.get(cache_prefix + k) for k in stats}

        if None not in stats.values():
            print("Displaying cached data.")
        else:
            url = "%s/athletes/%s/stats" % (STRAVA_BASE, athlete)
            print("Calling Strava API: " + url)
            response = http_get(url, headers = headers)

            if response.status_code != 200:
                text = "code %d, %s" % (response.status_code, json.decode(response.body()).get("message", ""))
                return display_failure("Strava API failed, %s" % text)

            data = response.json()

            for per in ("ytd", "all"):
                for sport_code in ("ride", "run", "swim"):
                    this_cache_prefix = "%s/%s/%s/" % (refresh_token, sport_code, per)
                    for item in stats.keys():
                        if sport_code == sport:
                            stats[item] = data["%s_%s_totals" % (per, sport_code)][item]

                        # TODO: Determine if this cache call can be converted to the new HTTP cache.
                        cache.set(
                            this_cache_prefix + item,
                            str(data["%s_%s_totals" % (per, sport_code)][item]),
                            ttl_seconds = CACHE_TTL,
                        )

    # Configure the display to the user's preferences
    elevu = "m"
    if units.lower() == "imperial":
        if sport == "swim":
            stats["distance"] = round(meters_to_ft(float(stats["distance"])), 0)
            distu = "ft"
        else:
            stats["distance"] = round(meters_to_mi(float(stats["distance"])), 1)
            distu = "mi"
            elevu = "ft"
        stats["elevation_gain"] = round(meters_to_ft(float(stats["elevation_gain"])), 0)
    elif sport != "swim":
        stats["distance"] = round(meters_to_km(float(stats["distance"])), 0)
        distu = "km"
    else:
        distu = "m"

    if sport == "all":
        if int(float(stats["count"])) != 1:
            actu = "activities"
        else:
            actu = "activity"
    else:
        actu = sport
        if int(float(stats["count"])) != 1:
            actu += "s"

    display_header = []

    sport_verb = {
        "run": "running",
        "ride": "cycling",
        "swim": "swim",
    }[sport]

    if period == "ytd":
        display_header.append(
            render.Row(
                expanded = True,
                main_align = "center",
                cross_align = "center",
                children = [render.Text(" %d %s" % (year, sport_verb.capitalize()), font = "tb-8")],
            ),
        )

    sport_icon = {
        "run": RUN_ICON,
        "ride": RIDE_ICON,
        "swim": SWIM_ICON,
    }[sport]

    # The number of activities and distance traveled is universal, but for cycling the elevation gain is a
    # more interesting statistic than speed so we"ll vary the third item:
    if sport == "ride" and float(stats.get("elevation_gain", 0)) > 0:
        third_stat = {
            "icon": ELEV_ICON,
            "text": "%s %s" % (humanize.comma(float(stats.get("elevation_gain", 0))), elevu),
        }
    else:
        if float(stats.get("distance", 0)) > 0:
            split = float(stats.get("moving_time", 0)) // float(stats.get("distance", 0))
            split = time.parse_duration(str(split) + "s")
            split = format_duration(split)
        else:
            split = "N/A"

        third_stat = {
            "icon": CLOCK_ICON,
            "text": "%s%s" % (split, "/" + distu),
        }

    return render.Root(
        delay = 0,
        child = render.Column(
            expanded = True,
            cross_align = "start",
            main_align = "space_evenly",
            children = [
                render.Row(
                    cross_align = "center",
                    children = display_header,
                ),
                render.Animation(
                    children = [
                        render.Row(
                            main_align = "space_between",
                            cross_align = "center",
                            children = [
                                render.Image(src = sport_icon),
                                render.Box(height = 8, width = max(64 - i, 1)),
                                render.Text("%s " % humanize.comma(float(stats.get("count", 0)))),
                                render.Text(actu, font = "tb-8"),
                            ],
                        )
                        for i in range(799 if no_anim else 0, 800)
                    ],
                ),
                render.Animation(
                    children = [
                        render.Row(
                            main_align = "space_between",
                            cross_align = "center",
                            children = [
                                render.Image(src = DISTANCE_ICON_FIXED if no_anim else DISTANCE_ICON),
                                render.Box(height = 8, width = max(74 - i, 1)),
                                render.Text("%s " % humanize.comma(float(stats.get("distance", 0)))),
                                render.Text(distu, font = "tb-8"),
                            ],
                        )
                        for i in range(799 if no_anim else 0, 800)
                    ],
                ),
                render.Animation(
                    children = [
                        render.Row(
                            main_align = "space_between",
                            cross_align = "center",
                            children = [
                                render.Image(src = third_stat["icon"]),
                                render.Box(height = 8, width = max(84 - i, 1)),
                                render.Text(third_stat["text"]),
                            ],
                        )
                        for i in range(799 if no_anim else 0, 800)
                    ],
                ),
            ],
        ),
    )

def last_activity(config, refresh_token, sport, units):
    show_logo = config.bool("show_logo", True)
    no_anim = config.bool("no_anim", True)
    title_font = "CG-pixel-3x5-mono"

    if units == "metric":
        distance_conv = meters_to_km
    else:
        distance_conv = meters_to_mi

    activities = get_activities(config, refresh_token)

    filtered = [a for a in activities["current"] if a["type"].lower() == sport.lower()]
    if not len(filtered):
        filtered = [a for a in activities["previous"] if a["type"].lower() == sport.lower()]
    if not len(filtered):
        # Skip display if the athlete has no activities in the past 2 months
        print("No recent %ss found" % sport)
        return []
    display_activity = filtered[-1]

    map_info = display_activity.get("map", {})
    polyline = map_info.get("summary_polyline", map_info.get("polyline", None))
    title = []
    if show_logo:
        sport_icon = {
            "run": RUN_ICON,
            "ride": RIDE_ICON,
            "swim": SWIM_ICON,
        }[sport]
        title.append(
            render.Image(src = sport_icon),
        )

    total_time = format_duration(
        time.parse_duration("%ss" % display_activity.get("moving_time", 0)),
        resolution = "hours",
    )

    if display_activity.get("heartrate_opt_out", False) or (
        not display_activity.get("has_heartrate") or display_activity.get("average_heartrate", 0) == 0
    ):
        if sport == "ride" and display_activity.get("average_watts", 0) > 0:
            work_stat = {
                "icon": WATTS_ICON,
                "value": display_activity.get("average_watts"),
            }
        elif display_activity.get("kilojoules", 0) > 0:
            work_stat = {
                "icon": KCAL_ICON,
                "value": kj_to_calories(display_activity.get("kilojoules", 0)),
            }
        else:
            work_stat = {
                "icon": SUFFER_ICON,
                "value": math.round(display_activity.get("suffer_score", 0)),
            }
    else:
        work_stat = {
            "icon": HEART_ICON,
            "value": int(display_activity.get("average_heartrate", 0)),
        }

    elev = display_activity.get("total_elevation_gain", 0)
    if sport == "ride":
        if units == "imperial":
            elev = meters_to_ft(elev)

    if float(display_activity.get("distance", 0)) > 0:
        distance = distance_conv(float(display_activity.get("distance", 1)))
        split = float(display_activity.get("moving_time", 0)) / distance
        split = time.parse_duration(str(split) + "s")
        split = format_duration(split)
    else:
        split = "N/A"

    pace_stat = render.Column(
        main_align = "center",
        cross_align = "center",
        children = [
            render.Text("Pace", color = "#fc4c02", font = title_font),
            render.Text(split, color = "#FFF"),
        ],
    )

    time_stat = render.Column(
        main_align = "center",
        cross_align = "center",
        children = [
            render.Text("Time", color = "#fc4c02", font = title_font),
            render.Text(total_time, color = "#FFF"),
        ],
    )

    top_row = [
        time_stat if sport == "ride" else pace_stat,
        render.Box(width = 1, height = 10, color = "#0000"),  # Force spacing + row height to 10px
        render.Column(
            main_align = "center",
            cross_align = "center",
            children = [
                render.Text("Dist", color = "#fc4c02", font = title_font),
                render.Text(
                    humanize.comma(math.round(distance_conv(display_activity.get("distance", 0)))),
                    color = "#FFF",
                ),
            ],
        ),
    ]

    render_layers = []

    # This gives better spacing if there is no map
    stat_spacing = "space_around"

    if polyline:
        coordinates = decode_polyline(polyline)

        # Slight rotation helps certain routes fit better on the screen
        degrees_rotation = 15
        theta = math.radians(degrees_rotation)
        coordinates = [
            (
                math.cos(theta) * y + math.sin(theta) * x,
                math.cos(theta) * x - math.sin(theta) * y,
            )
            for x, y in coordinates
        ]

        n_frames = min(len(coordinates), 100)  # no more than 10 seconds for full animation
        speed = max(len(coordinates) / n_frames, 1)
        speed = int(speed) + 1 if speed > len(coordinates) // n_frames else int(speed)

        if no_anim:
            plot = [
                render.Row(
                    expanded = True,
                    main_align = "center",
                    cross_align = "center",
                    children = [
                        render.Plot(
                            data = coordinates,
                            width = 32,
                            height = 32,
                            color = "#fc4c02",
                        ),
                    ],
                ),
            ]
        else:
            plot = [
                render.Row(
                    expanded = True,
                    main_align = "center",
                    cross_align = "center",
                    children = [
                        render.Plot(
                            data = coordinates,
                            width = 32,
                            height = 32,
                            color = "#6d6d7833",
                        ),
                    ],
                ),
                # Bright moving tip
                render.Row(
                    expanded = True,
                    main_align = "center",
                    cross_align = "center",
                    children = [
                        render.Animation(
                            children = list([
                                render.Plot(
                                    data = coordinates[int(i * speed):int(i * speed) + speed],
                                    width = 32,
                                    height = 32,
                                    color = "#ffa078",
                                    x_lim = (min([x for x, _ in coordinates]), max([x for x, _ in coordinates])),
                                    y_lim = (min([y for _, y in coordinates]), max([y for _, y in coordinates])),
                                )
                                for i in range(n_frames + 1)
                            ]),
                        ),
                    ],
                ),
                # Darker moving line
                render.Row(
                    expanded = True,
                    main_align = "center",
                    cross_align = "center",
                    children = [
                        render.Animation(
                            children = list([
                                render.Plot(
                                    data = coordinates[int(i * speed) - speed:int(i * speed) + 1],
                                    width = 32,
                                    height = 32,
                                    color = "#fc4c02",
                                    x_lim = (min([x for x, _ in coordinates]), max([x for x, _ in coordinates])),
                                    y_lim = (min([y for _, y in coordinates]), max([y for _, y in coordinates])),
                                )
                                for i in range(n_frames + 1)
                            ]),
                        ),
                    ],
                ),
                # Background line:
                render.Row(
                    expanded = True,
                    main_align = "center",
                    cross_align = "center",
                    children = [
                        render.Animation(
                            children = list([
                                render.Plot(
                                    data = coordinates[0:int(i * speed) + speed],
                                    width = 32,
                                    height = 32,
                                    color = "#fc4c0277",
                                    x_lim = (min([x for x, _ in coordinates]), max([x for x, _ in coordinates])),
                                    y_lim = (min([y for _, y in coordinates]), max([y for _, y in coordinates])),
                                )
                                for i in range(n_frames + 1)
                            ]),
                        ),
                    ],
                ),
            ]

        render_layers.append(
            render.Column(
                expanded = True,
                main_align = "center",
                cross_align = "center",
                children = [
                    render.Stack(
                        children = plot,
                    ),
                ],
            ),
        )

        stat_spacing = "space_between"
    else:
        top_row.extend(
            [
                render.Box(width = 1, height = 10, color = "#0000"),  # Force spacing + row height to 10px
                pace_stat if sport == "ride" else time_stat,
            ],
        )

    render_layers.append(
        render.Column(
            expanded = True,
            main_align = "start",
            children = [
                # Top Row (Time/Distance)
                render.Row(
                    expanded = True,
                    main_align = stat_spacing,
                    cross_align = "center",
                    children = top_row,
                ),
                # Middle Row
                render.Row(
                    expanded = True,
                    main_align = stat_spacing,
                    cross_align = "center",
                    children = [
                        render.Row(
                            cross_align = "center",
                            main_align = stat_spacing,
                            children = [
                                render.Image(PR_ICON),
                                render.Text(" " + humanize.comma(display_activity.get("pr_count", 0))),
                            ] if display_activity.get("pr_count", 0) > 0 else [
                                render.Box(width = 1, height = 10, color = "#0000"),
                            ],
                        ),
                        render.Box(width = 1, height = 10, color = "#0000"),  # Force spacing & height to 10px
                        render.Row(
                            cross_align = "center",
                            main_align = stat_spacing,
                            children = [
                                render.Text(" " + humanize.comma(display_activity.get("kudos_count"))),
                                render.Image(KUDOS_ICON),
                            ] if display_activity.get("kudos_count", 0) > 0 else [
                                render.Box(width = 1, height = 10, color = "#0000"),
                            ],
                        ),
                    ],
                ),
                # Bottom Row
                render.Row(
                    expanded = True,
                    main_align = stat_spacing,
                    cross_align = "center",
                    children = [
                        render.Row(
                            cross_align = "center",
                            main_align = stat_spacing,
                            children = [
                                render.Image(ACHIEVEMENT_ICON),
                                render.Text(" " + humanize.comma(display_activity.get("achievement_count"))),
                            ] if display_activity.get("achievement_count", 0) > 0 else [
                                render.Image(ELEV_ICON),
                                render.Text(" " + humanize.comma(int(elev))),
                            ] if elev > 0 else [
                                render.Box(width = 1, height = 10, color = "#0000"),
                            ],
                        ),
                        render.Box(width = 1, height = 10, color = "#0000"),  # Force spacing & row height to 10px
                        render.Row(
                            cross_align = "center",
                            main_align = stat_spacing,
                            # This is either the avg HR or calories burned
                            children = [
                                render.Text(humanize.comma(int(work_stat["value"]))),
                                render.Image(work_stat["icon"]),
                            ],
                        ),
                    ],
                ),
            ],
        ),
    )

    return render.Root(
        delay = 0,
        child = render.Stack(
            children = render_layers,
        ),
    )

def get_activities(config, refresh_token):
    max_activities = 200

    timezone = config.get("timezone") or "America/New_York"
    now = time.now().in_location(timezone)
    beg_curr_month = time.time(year = now.year, month = now.month, day = 1)

    end_prev_month = beg_curr_month - time.parse_duration("1ns")
    beg_prev_month = time.time(year = end_prev_month.year, month = end_prev_month.month, day = 1)

    if not refresh_token:
        activities = {
            "current": [],
            "previous": [],
        }
    else:
        access_token = cache.get(refresh_token)
        if not access_token:
            print("Generating new access token")
            access_token = get_access_token(refresh_token)

        headers = {
            "Authorization": "Bearer %s" % access_token,
        }

        # To help reduce the number of API calls we need, I'm querying both months together (current/prev commented)
        # The consequence here is if the athlete completed more than 200 activities in the last 2 months we'll miss some
        urls = {
            "last-2": "%s/athlete/activities?after=%s&per_page=%s" % (STRAVA_BASE, beg_prev_month.unix, max_activities),
            # "current": "%s/athlete/activities?after=%s&per_page=%s" % (STRAVA_BASE, beg_curr_month.unix, max_activities),
            # "previous": "%s/athlete/activities?after=%s&before=%s&per_page=%s" % (STRAVA_BASE, beg_prev_month.unix, end_prev_month.unix, max_activities),
        }

        activities = {}

        for query, url in urls.items():
            cache_id = "%s/xactivity/%s/%s-%s" % (refresh_token, query, now.year, now.month)
            data = cache.get(cache_id)

            if not data:
                print("Getting %s month activities. %s" % (query, url))
                response = http_get(url, headers = headers)
                if response.status_code != 200:
                    text = "code %d, %s" % (response.status_code, json.decode(response.body()).get("message", ""))
                    return display_failure("Strava API failed, %s" % text)
                data = response.json()

                # TODO: Determine if this cache call can be converted to the new HTTP cache.
                cache.set(cache_id, json.encode(data), ttl_seconds = CACHE_TTL)
            else:
                print("Returning cached %s month activities." % query)
                data = json.decode(data)

            activities[query] = data

    # Sort each list chronologically
    for query in activities.keys():
        activities[query] = sorted(activities[query], key = lambda x: x["start_date"])

    # Per above, split list into current and previous month
    activities["current"] = [a for a in activities["last-2"] if time.parse_time(a["start_date"]) >= beg_curr_month]
    activities["previous"] = [a for a in activities["last-2"] if time.parse_time(a["start_date"]) < beg_curr_month]
    activities.pop("last-2", None)

    return activities

def decode_polyline(polyline_str):
    """
    Converts a compressed series of GPS coordinates (i.e. Polyline) back into coordinates that we can plot.

    Implementation borrowed from https://github.com/geodav-tech/decode-google-maps-polyline

    :param polyline_str: Compressed coordinates as a string
    :return: list of tuples: latitude, longitude
    """
    index, lat, lng = 0, 0, 0
    coordinates = []
    changes = {"latitude": 0, "longitude": 0}

    # Coordinates have variable length when encoded, so just keep
    # track of whether we've hit the end of the string. In each
    # pseudo-while loop iteration, a single coordinate is decoded.
    for _ in range(int(1e10)):
        if index >= len(polyline_str):
            break

        # Gather lat/lon changes, store them in a dictionary to apply them later
        for unit in ["latitude", "longitude"]:
            shift, result = 0, 0

            for _ in range(len(polyline_str)):
                if index >= len(polyline_str):
                    break
                byte = ord(polyline_str[index]) - 63
                index += 1
                result |= (byte & 0x1f) << shift
                shift += 5
                if not byte >= 0x20:
                    break

            if result & 1:
                changes[unit] = ~(result >> 1)
            else:
                changes[unit] = (result >> 1)

        lat += changes["latitude"]
        lng += changes["longitude"]

        coordinates.append((lat / 100000.0, lng / 100000.0))

    return coordinates

def kj_to_calories(kj):
    return float(kj) / 4.184

def meters_to_mi(m):
    return m * 0.00062137

def meters_to_km(m):
    return m // 1000

def meters_to_ft(m):
    return m * 3.280839895

def round(num, precision):
    return math.round(num * math.pow(10, precision)) / math.pow(10, precision)

def format_duration(d, resolution = "minutes"):
    if resolution == "minutes":
        m = int(d.minutes)
        s = str(int((d.minutes - m) * 60))
        m = str(m)
        if len(s) == 1:
            s = "0" + s
        return "%s:%s" % (m, s)

    elif resolution == "hours":
        h = int(d.hours)
        m = str(int((d.hours - h) * 60))
        m = str(m)
        if len(m) == 1:
            m = "0" + m
        return "%s:%s" % (h, m)

    else:
        # Should never get here.
        return ""

def oauth_handler(params):
    params = json.decode(params)
    auth_code = params.get("code")
    return get_refresh_token(auth_code)

def get_refresh_token(auth_code):
    params = dict(
        code = auth_code,
        client_secret = OAUTH2_CLIENT_SECRET,
        grant_type = "authorization_code",
        client_id = CLIENT_ID,
    )

    res = http.post(
        url = "https://www.strava.com/api/v3/oauth/token",
        headers = {
            "Accept": "application/json",
        },
        params = params,
        form_encoding = "application/x-www-form-urlencoded",
    )
    if res.status_code != 200:
        fail("token request failed with status code: %d - %s" %
             (res.status_code, res.body()))

    token_params = res.json()
    refresh_token = token_params["refresh_token"]
    access_token = token_params["access_token"]
    athlete = int(float(token_params["athlete"]["id"]))

    # TODO: Determine if this cache call can be converted to the new HTTP cache.
    cache.set(refresh_token, access_token, ttl_seconds = int(token_params["expires_in"] - 30))

    # TODO: Determine if this cache call can be converted to the new HTTP cache.
    cache.set("%s/athlete_id" % refresh_token, str(athlete), ttl_seconds = CACHE_TTL)

    return refresh_token

def get_access_token(refresh_token):
    params = dict(
        refresh_token = refresh_token,
        client_secret = OAUTH2_CLIENT_SECRET,
        grant_type = "refresh_token",
        client_id = CLIENT_ID,
    )

    res = http.post(
        url = "https://www.strava.com/api/v3/oauth/token",
        headers = {
            "Accept": "application/json",
        },
        params = params,
        form_encoding = "application/x-www-form-urlencoded",
    )
    if res.status_code != 200:
        fail("token request failed with status code: %d - %s" %
             (res.status_code, res.body()))

    token_params = res.json()
    access_token = token_params["access_token"]

    # TODO: Determine if this cache call can be converted to the new HTTP cache.
    cache.set(refresh_token, access_token, ttl_seconds = int(token_params["expires_in"] - 30))

    return access_token

def display_failure(msg):
    return render.Root(
        child = render.Column(
            children = [
                render.Marquee(
                    width = 64,
                    child = render.Text(msg),
                ),
            ],
        ),
    )

def is_rate_limited():
    return cache.get(RATE_LIMIT_CACHE_KEY)

def http_get(url, headers = None):
    res = http.get(url, headers = headers)

    if res.status_code == 429:
        # rate-limit exceeded. as of this writing, Strava doesn't return a
        # Retry-After header. but if they start doing so, we'll respect it.
        # in the absence of that header, we backoff for some reasonable
        # default number of seconds.
        backoff = res.headers.get("Retry-After", RATE_LIMIT_DEFAULT_BACKOFF_SECONDS)

        # TODO: Determine if this cache call can be converted to the new HTTP cache.
        cache.set(
            RATE_LIMIT_CACHE_KEY,
            "back off, buddy",
            ttl_seconds = int(backoff),
        )

    return res

def get_schema():
    units_options = [
        schema.Option(value = "imperial", display = "Imperial (US)"),
        schema.Option(value = "metric", display = "Metric"),
    ]

    screen_options = [
        schema.Option(value = "all", display = "All-time stats"),
        schema.Option(value = "ytd", display = "YTD stats"),
        schema.Option(value = "progress_chart", display = "Monthly progress"),
        schema.Option(value = "last_activity", display = "Last activity"),
    ]

    sport_options = [
        schema.Option(value = "ride", display = "Cycling"),
        schema.Option(value = "run", display = "Running"),
        schema.Option(value = "swim", display = "Swimming"),
    ]

    return schema.Schema(
        version = "1",
        fields = [
            schema.OAuth2(
                id = "auth",
                name = "Strava Login",
                desc = "Connect to your Strava account",
                icon = "user",
                client_id = str(CLIENT_ID),
                handler = oauth_handler,
                authorization_endpoint = "https://www.strava.com/oauth/authorize",
                scopes = [
                    "read,activity:read",
                ],
            ),
            schema.Dropdown(
                id = "sport",
                name = "Activity type",
                desc = "Runs, rides or swims are all supported!",
                icon = "personRunning",
                options = sport_options,
                default = "ride",
            ),
            schema.Dropdown(
                id = "units",
                name = "Distance units",
                desc = "Imperial displays miles and feet, metric displays kilometers and meters.",
                icon = "penRuler",
                options = units_options,
                default = DEFAULT_UNITS,
            ),
            schema.Dropdown(
                id = "display_type",
                name = "Screen type",
                desc = "Show your cumulative stats or a progress chart.",
                icon = "userClock",
                options = screen_options,
                default = DEFAULT_SCREEN,
            ),
            schema.Toggle(
                id = "show_logo",
                name = "Icon",
                desc = "Whether to display the sport icon on progress charts.",
                icon = "gear",
                default = True,
            ),
            schema.Toggle(
                id = "no_anim",
                name = "No animations",
                desc = "Toggle on to remove all animations for this view.",
                icon = "gear",
                default = False,
            ),
        ],
    )
